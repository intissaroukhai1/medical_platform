{% extends 'secretaire/_layout_secretaire.html.twig' %}

{% block secretaire_content %}

<div class="header">
    <h1>Dashboard SecrÃ©taire</h1>

    <div class="user-profile">
        <div class="user-info">
            <div class="user-name">
                {{ secretaire.prenom }} {{ secretaire.nom }}
            </div>
            <div class="user-role">
                {{ secretaire.poste ?? 'SecrÃ©taire MÃ©dicale' }}
            </div>
        </div>

        <div class="user-avatar">
            {{ secretaire.prenom|first|upper }}{{ secretaire.nom|first|upper }}
        </div>
    </div>
</div>

<!-- Stats Cards -->
<div class="dashboard-grid">
    <div class="card">
        <div class="card-header">
            <div class="card-title">Patients</div>
            <div class="card-icon">ğŸ‘¥</div>
        </div>
        <div class="card-value">{{ patientsCount }}</div>
        <div class="card-description">EnregistrÃ©s</div>
    </div>

    <div class="card">
        <div class="card-header">
            <div class="card-title">RDV Aujourd'hui</div>
            <div class="card-icon">ğŸ“…</div>
        </div>
        <div class="card-value"> {{ rdvToday  }}</div>
        <div class="card-description">PrÃ©vus</div>
    </div>

    <div class="card">
        <div class="card-header">
            <div class="card-title">En attente</div>
            <div class="card-icon">â³</div>
        </div>
        <div class="card-value">{{ rdvEnAttente }}</div>
        <div class="card-description">Ã€ confirmer</div>
    </div>

    <div class="card">
        <div class="card-header">
            <div class="card-title">MÃ©decins</div>
            <div class="card-icon">ğŸ‘¨â€âš•ï¸</div>
        </div>
        <div class="card-value">8</div>
        <div class="card-description">Actifs</div>
    </div>
</div>



<!-- Appointments -->
<div class="table-section">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 class="section-title">Rendez-vous d'Aujourd'hui</h2>
        <button class="btn btn-primary" onclick="alert('Ajouter RDV')">+ Nouveau RDV</button>
    </div>

    {% if rdvTodayList is empty %}
    <p>Aucun rendez-vous aujourdâ€™hui</p>
{% else %}
    {% for rdv in rdvTodayList %}
        <div class="appointment-item">
            <div class="appointment-info">
                <div class="appointment-header">
                    {{ rdv.patient.prenom }} {{ rdv.patient.nom }}
                    
                </div>
                <div class="appointment-detail">
                    â° {{ rdv.date|date('H:i') }}
                </div>
            </div>

            <div class="action-buttons">
                {% if rdv.statut == constant('App\\Entity\\RendezVous::STATUT_EN_ATTENTE') %}
                    <form method="post"
                          action="{{ path('secretaire_rdv_confirmer', {id: rdv.id}) }}">
                        <input type="hidden" name="_token"
                               value="{{ csrf_token('confirm-rdv-' ~ rdv.id) }}">
                        <button class="btn btn-primary btn-small">Confirmer</button>
                    </form>
                {% endif %}

               <form method="post"
          action="{{ path('secretaire_rdv_rappel', {id: rdv.id}) }}">
        <input type="hidden" name="_token"
               value="{{ csrf_token('remind-rdv-' ~ rdv.id) }}">
        <button class="btn btn-warning btn-small">
            ğŸ”” Rappel
        </button>
    </form>

    <!-- âŒ Annuler -->
    <form method="post"
          action="{{ path('secretaire_rdv_annuler', {id: rdv.id}) }}">
        <input type="hidden" name="_token"
               value="{{ csrf_token('cancel-rdv-' ~ rdv.id) }}">
        <button class="btn btn-danger btn-small">
            Annuler
        </button>
    </form>

            </div>
        </div>
    {% endfor %}
{% endif %}

</div>

{% endblock %}